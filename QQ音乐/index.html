<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <script src="https://www.jq22.com/jquery/jquery-3.3.1.js"></script>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            list-style: none;
        }

        [v-cloak] {
            display: none;
        }

        #con::-webkit-scrollbar {
            display: none;
        }
    </style>
</head>


<body>
    <div id="box" v-cloak="">
        <!-- 头部 -->
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar"
                        aria-expanded="false" aria-controls="navbar">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="#">QQ音乐</a>
                </div>
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li class="active"><a href="#/">首页</a></li>
                        <li><a href="#/no2">排行版</a></li>
                        <li><a href="#/no3">歌手</a></li>
                        <li><a href="#/no4">歌单</a></li>
                        <li><a href="#/no5">播放列表</a></li>
                    </ul>
                </div>
                <!--/.nav-collapse -->
            </div>
        </nav>
        <!-- 中间 -->
        <div style="min-height: 500px;padding-top: 100px;">
            <keep-alive>
                <router-view></router-view>
            </keep-alive>


        </div>
        <!-- 底部 -->
        <div style="height:150px;background: #cccccc;">
            <div style="text-align: center;line-height: 200px;">
                <audio :src="url" controls autoplay></audio>
            </div>

        </div>
    </div>
    <template id="no1">
        <div>
            <div>
                <div class="input-group" style="width:800px;margin: 0 auto;">
                    <div style="display: flex;">
                        <input v-model="value" @keyup.enter="search" type="text" class="form-control"
                            aria-label="Amount (to the nearest dollar)">
                        <span class="input-group-addon" style="width: 40px;padding-top: 10px;"><span
                                class="glyphicon glyphicon-search"></span></span>
                    </div>
                    <!-- 热搜 -->
                    <div style="margin-top: 20px;">
                        <span @click="xjbx(i.k)" v-for="i in hotkey"
                            style="display: inline-block;;margin: 5px;border: 1px #000 solid;padding: 5px;">
                            {{i.k}}
                        </span>
                    </div>
                    <!-- 歌名 -->
                    <div v-if="search2" id="con"
                        style="overflow-y: scroll;height:300px;padding: 10px 0;line-height: 20px;border: 1px solid #cccccc;">
                        <p v-for="i in search2">
                            <a :href="'#/no5/'+i.songmid+'/'+i.songname">{{i.songname}}</a>

                        </p>
                    </div>
                </div>
            </div>
        </div>
    </template>
    <template id="no2">
        <div style="overflow: hidden;">
            <div v-for="i in php" style="float: left;width: 23%">
                <div style="float: left;padding: 40px 38px;margin: 0 auto;">
                    <img :src="i.picUrl" alt="">
                </div>
                <p>
                    <a :href="'#/ppp/'+i.id">点击查看详情</a>
                </p>
                <div v-for="a in i.songList">
                    <p style="overflow: hidden;white-space:nowrap;">
                        {{a.songname}}
                        <span style="float: right;overflow: hidden;white-space:nowrap;">

                            {{a.singername}}
                        </span>
                    </p>

                </div>

            </div>
        </div>
    </template>
    <template id="no3">
        <div>
            <!-- 渲染歌手 -->
            <div v-for="i in object">
                <p style="padding: 0 260px;">
                    <a :href="'#/geshou/'+i.Fsinger_mid">
                        {{i.Fsinger_name}}
                    </a>
                </p>
            </div>
        </div>
    </template>
    <template id="no4">
        <div>
            歌单
        </div>
    </template>
    <template id="no5">
        <div>

        </div>
    </template>0
    <template id="geshou">
        <div>
            <div>
                <p v-for="i in zaa">
                    <a :href="'#/no5/'+i.musicData.songmid+'/'+i.musicData.songname">{{i.musicData.songname}}</a>
                </p>
            </div>
        </div>
    </template>
    <template id="ppp">
        <div>
            <div v-for="i in lll">
                <p>
                    <a :href="'#/no5/'+i.data.songmid+'/'+i.data.songname"> {{i.data.songname}}</a>
                    <span style="float: right;">
                        {{i.data.singer[0].name}}
                    </span>
                </p>
            </div>
        </div>

    </template>
</body>
</html>
<script src="vue.luyou/node_modules/vue/dist/vue.js"></script>
<script src="vue.luyou/node_modules/vue-router/dist/vue-router.js"></script>
<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"
    integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous">
</script>
<script src="vue-resource.js"></script>
<script>
    var router = new VueRouter({
        routes: [{
                path: '/',
                component: {
                    template: '#no1',
                    data() {
                        return {
                            value: '',
                            search2: '',
                            hotkey: '',
                        }
                    },
                    methods: {
                        xjbx(a) {
                            this.value = a
                            this.search()
                        },
                        search() {
                            this.$http.jsonp(
                                'https://c.y.qq.com/soso/fcgi-bin/client_search_cp?g_tk=5381&p=1&n=20&w=' +
                                this.value +
                                '&format=jsonp&jsonpCallback=callback&loginUin=0&hostUin=0&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0&remoteplace=txt.yqq.song&t=0&aggr=1&cr=1&catZhida=1&flag_qc=0', {
                                    jsonpCallback: 'callback',
                                }).then((data) => {
                                console.log(data)
                                this.search2 = data.data.data.song.list;
                            })
                        }
                    },
                    created() {
                        this.$http.jsonp(
                            'https://c.y.qq.com/splcloud/fcgi-bin/gethotkey.fcg?g_tk=5381&uin=0&format=jsonp&jsonpCallback=callback&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&_=1513317614040', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            console.log(data.data.data.hotkey)
                            this.hotkey = data.data.data.hotkey
                        })
                    }
                }
            },
            {
                path: '/no2',
                component: {
                    template: '#no2',
                    data() {
                        return {
                            php: '',
                        }
                    },
                    created() {
                        this.$http.jsonp(
                            'https://c.y.qq.com/v8/fcg-bin/fcg_myqq_toplist.fcg?g_tk=5381&uin=0&format=jsonp&jsonpCallback=callback&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&_=1512554796112', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            console.log(data.data.data.topList)
                            this.php = data.data.data.topList
                        })
                    }
                }
            },
            {
                path: '/ppp/:id',
                component: {
                    template: '#ppp',
                    data() {
                        return {
                            lll: '',
                        }
                    },
                    created() {
                        this.$http.jsonp(
                            'https://c.y.qq.com/v8/fcg-bin/fcg_v8_toplist_cp.fcg?g_tk=5381&uin=0&format=jsonp&jsonpCallback=callback&inCharset=utf-8&outCharset=utf-8&notice=0&platform=h5&needNewCode=1&tpl=3&page=detail&type=top&topid=' +
                            this.$route.params.id + '&_=1512563984096', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            console.log(data.data.songlist)
                            this.lll = data.data.songlist
                        })
                    }
                }
            },
            {
                path: '/no3',
                component: {
                    template: '#no3',
                    data() {
                        return {
                            object: '',
                        }
                    },
                    created() {
                        this.$http.jsonp(
                            'https://c.y.qq.com/v8/fcg-bin/v8.fcg?channel=singer&page=list&key=all_all_all&pagesize=100&pagenum=1&g_tk=5381&jsonpCallback=callback&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            console.log(data.data.data.list)
                            this.object = data.data.data.list
                        })
                    }
                }
            },
            {
                path: '/no4',
                component: {
                    template: '#no4'
                }
            },
            {
                path: '/geshou/:id',
                component: {
                    template: '#geshou',
                    data() {
                        return {
                            zaa: '',
                        }
                    },
                    created() {
                        this.$http.jsonp(
                            'https://c.y.qq.com/v8/fcg-bin/fcg_v8_singer_track_cp.fcg?g_tk=5381&jsonpCallback=callback&loginUin=0&hostUin=0&format=jsonp&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0&singermid=' +
                            this.$route.params.id + '&order=listen&begin=0&num=30&songstatus=1', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            console.log(data.data.data.list)
                            this.zaa = data.data.data.list
                        })
                    },

                }
            },
            {
                path: '/no5/:songmid/:songname',
                component: {
                    template: '#no5',
                    data() {
                        return {
                            arr: []
                        }
                    },
                    created() {
                        var songmid = this.$route.params.songmid;
                        var play_name = this.$route.params.songname;
                        if (this.$route.params.songmid) {
                            if (this.$route.params.songmid != 0 || this.$route.params.songname != 0) {
                                this.arr.push(this.$route.params.songname)
                            }
                        }
                    },
                    watch: {
                        '$route.params'(a) {
                            this.songmid = this.$route.params.songmid
                            this.sname = this.$route.params.songname
                            console.log(this.$route.params)
                            if (this.$route.params.songmid) {
                                if (this.$route.params.songmid != 0 || this.$route.params.songname != 0) {
                                    this.arr.push(this.$route.params.songname)
                                }
                            }
                        }
                    }
                }
            },
        ]
    })



    new Vue({
        el: '#box',
        router,
        data: {
            url: '',
            arr: [{
                    name: '首页',
                    path: '#/'
                },
                {
                    name: '排行榜',
                    path: '#/no2'
                },
                {
                    name: '歌手',
                    path: '#/no3'
                },
                {
                    name: '歌单',
                    path: '#/no4'
                },
                {
                    name: '播放列表',
                    path: '#/no5'
                },
            ]
        },
        watch: {
            "$route.params"(a, b) {
                if (a.songmid) {
                    if (a.songmid != 0 && a.songname != 0) {
                        this.$http.jsonp(
                            'https://c.y.qq.com/base/fcgi-bin/fcg_music_express_mobile3.fcg?g_tk=1278911659&hostUin=0&format=jsonp&callback=callback&inCharset=utf8&outCharset=utf-8&notice=0&platform=yqq&needNewCode=0&cid=205361747&uin=0&songmid=' +
                            a.songmid + '&filename=C400' + a.songmid + '.m4a&guid=3655047200', {
                                jsonpCallback: 'callback',
                            }).then((data) => {
                            var filename = data.body.data.items[0].filename
                            var key = data.body.data.items[0].vkey
                            this.url =
                                ` http://dl.stream.qqmusic.qq.com/${filename}?vkey=${key}&guid=3655047200&fromtag=66`
                        })
                    }
                }
            }
        }
    })
</script>